NGINX настраивается с помощью файла в `/etc/nginx/sites-available`.
Вам необходимо создать файл и включить его.

Создайте файл конфигурации, выполнив следующую команду:

> `sudo touch /etc/nginx/sites-available/conf_file`на Ubuntu
> 
> `sudo touch /etc/nginx/conf.d/conf_file`на RHEL 8

Открыть файл `/etc/nginx/sites-available/mattermost`(Ubuntu) или `/etc/nginx/conf.d/mattermost`(RHEL 8) от имени _пользователя root_ в текстовом редакторе.
```Nginx
upstream backend {
   server <IP>:<PORT>;
   keepalive 32;
}
```

Директива **`keepalive`** в блоке **`upstream`** относится к **поддержанию постоянных соединений (keep-alive connections)** между Nginx (как обратным прокси) и **backend-серверами**.

Проксирование на порт:
```Nginx
server {
  listen 80 default_server;
  server_name example.com;
  return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name example.com;

    ssl_certificate /etc/letsencrypt/live/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/privkey.pem;

    location / {
        proxy_pass http://backend;
        # Остальная настройка...
    }
}
```

Данная запись при запросе 80-ого порта сервера переадресует клиента на URL `https://$server_name$request_uri` где после записи `https://` идёт доменное имя
(код 301 означает, что сервер изменил URL).

`ssl_certificate` и `ssl_certificate_key`, это `SSL` сертификат и ключ соответственно.

Удалите существующий файл с поддержкой сайтов по умолчанию, выполнив `sudo rm /etc/nginx/sites-enabled/default`(Ubuntu) или `sudo rm /etc/nginx/conf.d/default`(RHEL 8)

Включите конфигурацию, выполнив `sudo ln -s /etc/nginx/sites-available/cfg /etc/nginx/sites-enabled/cfg`(Ubuntu) или `sudo ln -s /etc/nginx/conf.d/cfg /etc/nginx/conf.d/default.conf`(RHEL 8)

Перезапустите NGINX, выполнив команду `sudo systemctl restart nginx`.

Убедитесь, что вы видите страницу сайта через прокси-сервер, запустив `curl https://localhost`.

---
Пример config-а на базе сервиса mattermost:
```Nginx
upstream backend {
   server 10.10.10.2:8065;
   keepalive 32;
}

server {
  listen 80 default_server;
  server_name   mattermost.example.com;
  return 301 https://$server_name$request_uri;
}

server {
   listen 443 ssl http2;
   listen [::]:443 ssl http2;
   server_name    mattermost.example.com;

   ssl_certificate /etc/letsencrypt/live/{domain-name}/fullchain.pem;
   ssl_certificate_key /etc/letsencrypt/live/{domain-name}/privkey.pem;
   ssl_session_timeout 1d;

   # Enable TLS versions (TLSv1.3 is required upcoming HTTP/3 QUIC).
   ssl_protocols TLSv1.2 TLSv1.3;

   # Enable TLSv1.3's 0-RTT. Use $ssl_early_data when reverse proxying to
   # prevent replay attacks.
   #
   # @see: https://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_early_data
   ssl_early_data on;

   ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384';
   ssl_prefer_server_ciphers on;
   ssl_session_cache shared:SSL:50m;
   # HSTS (ngx_http_headers_module is required) (15768000 seconds = six months)
   add_header Strict-Transport-Security max-age=15768000;
   # OCSP Stapling ---
   # fetch OCSP records from URL in ssl_certificate and cache them
   ssl_stapling on;
   ssl_stapling_verify on;

   add_header X-Early-Data $tls1_3_early_data;

   location ~ /api/v[0-9]+/(users/)?websocket$ {
       proxy_set_header Upgrade $http_upgrade;
       proxy_set_header Connection "upgrade";
       client_max_body_size 50M;
       proxy_set_header Host $host;
       proxy_set_header X-Real-IP $remote_addr;
       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
       proxy_set_header X-Forwarded-Proto $scheme;
       proxy_set_header X-Frame-Options SAMEORIGIN;
       proxy_buffers 256 16k;
       proxy_buffer_size 16k;
       client_body_timeout 60s;
       send_timeout 300s;
       lingering_timeout 5s;
       proxy_connect_timeout 90s;
       proxy_send_timeout 300s;
       proxy_read_timeout 90s;
       proxy_http_version 1.1;
       proxy_pass http://backend;
   }

   location / {
       client_max_body_size 100M;
       proxy_set_header Connection "";
       proxy_set_header Host $host;
       proxy_set_header X-Real-IP $remote_addr;
       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
       proxy_set_header X-Forwarded-Proto $scheme;
       proxy_set_header X-Frame-Options SAMEORIGIN;
       proxy_buffers 256 16k;
       proxy_buffer_size 16k;
       proxy_read_timeout 600s;
       proxy_http_version 1.1;
       proxy_pass http://backend;
   }
}

# This block is useful for debugging TLS v1.3. Please feel free to remove this
# and use the `$ssl_early_data` variable exposed by NGINX directly should you
# wish to do so.
map $ssl_early_data $tls1_3_early_data {
  "~." $ssl_early_data;
  default "";
}
```